!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Annotorious=t():(e.Annotorious=e.Annotorious||{},e.Annotorious.BetterPolygon=t())}(self,(function(){return(()=>{var e={922:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(r)for(var u=0;u<this.length;u++){var c=this[u][0];null!=c&&(a[c]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);r&&a[l[0]]||(void 0!==i&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=i),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),o&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=o):l[4]="".concat(o)),t.push(l))}},t}},499:e=>{"use strict";e.exports=function(e){return e[1]}},94:e=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}e.exports=function e(n,r){if(n===r)return!0;if(n&&r&&"object"==t(n)&&"object"==t(r)){if(n.constructor!==r.constructor)return!1;var o,i,a;if(Array.isArray(n)){if((o=n.length)!=r.length)return!1;for(i=o;0!=i--;)if(!e(n[i],r[i]))return!1;return!0}if(n.constructor===RegExp)return n.source===r.source&&n.flags===r.flags;if(n.valueOf!==Object.prototype.valueOf)return n.valueOf()===r.valueOf();if(n.toString!==Object.prototype.toString)return n.toString()===r.toString();if((o=(a=Object.keys(n)).length)!==Object.keys(r).length)return!1;for(i=o;0!=i--;)if(!Object.prototype.hasOwnProperty.call(r,a[i]))return!1;for(i=o;0!=i--;){var u=a[i];if(!e(n[u],r[u]))return!1}return!0}return n!=n&&r!=r}},773:e=>{function t(){}t.prototype={on:function(e,t,n){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var r=this;function o(){r.off(e,o),t.apply(n,arguments)}return o._=t,this.on(e,o,n)},emit:function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),r=0,o=n.length;r<o;r++)n[r].fn.apply(n[r].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),r=n[e],o=[];if(r&&t)for(var i=0,a=r.length;i<a;i++)r[i].fn!==t&&r[i].fn._!==t&&o.push(r[i]);return o.length?n[e]=o:delete n[e],this}},e.exports=t,e.exports.TinyEmitter=t},424:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var r=n(499),o=n.n(r),i=n(922),a=n.n(i)()(o());a.push([e.id,"/** Rubberband **/\n.a9s-selection.improved-polygon .a9s-rubberband {\n  fill:rgba(255,255,255,0.15);\n  stroke-width:1px;\n  stroke:rgba(0, 0, 0, 0.3);\n}\n\n/** Polygon **/\n.a9s-selection.improved-polygon .a9s-inner,\n.a9s-annotation.improved-polygon.editable .a9s-inner {\n  stroke-width:2px;\n  stroke:#fff;\n  stroke-dasharray:5 3;\n}\n\n.a9s-annotation.improved-polygon.editable .a9s-inner:hover {\n  fill:transparent;\n}\n\n.a9s-selection.improved-polygon .a9s-outer,\n.a9s-annotation.improved-polygon.editable .a9s-outer {\n  stroke-width:4px;\n  stroke:rgba(0, 0, 0, 0.35);\n}\n\n/** Corner handles **/\n.a9s-selection.improved-polygon .a9s-handle .a9s-handle-outer,\n.a9s-annotation.improved-polygon.editable .a9s-handle .a9s-handle-outer {\n  stroke-width:1;\n  stroke:#000;  \n}\n\n.a9s-selection.improved-polygon .a9s-handle .a9s-handle-inner,\n.a9s-annotation.improved-polygon.editable .a9s-handle .a9s-handle-inner {\n  stroke-width:2;\n  stroke:#fff;\n  fill:#000;\n}\n\n.a9s-selection.improved-polygon .a9s-handle .a9s-handle-inner:hover,\n.a9s-annotation.improved-polygon.editable .a9s-handle.selected .a9s-handle-inner, \n.a9s-annotation.improved-polygon.editable .a9s-handle .a9s-handle-inner:hover {\n  fill:#fff;\n}\n\n/** Midpoints **/\n.a9s-annotation.improved-polygon.editable .a9s-midpoint {\n  display:none;\n  fill:rgba(255,255,255,0.65);\n  stroke-width:1;\n  stroke:rgba(0,0,0,0.65);\n}\n\n.a9s-annotation.improved-polygon.editable:hover .a9s-midpoint {\n  display:block;\n}\n\n.a9s-annotation.improved-polygon.editable .a9s-midpoint:hover {\n  fill:#fff;\n}",""]);const u=a},379:e=>{"use strict";var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var i={},a=[],u=0;u<e.length;u++){var c=e[u],s=r.base?c[0]+r.base:c[0],l=i[s]||0,f="".concat(s," ").concat(l);i[s]=l+1;var d=n(f),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==d)t[d].references++,t[d].updater(p);else{var y=o(p,r);r.byIndex=u,t.splice(u,0,{identifier:f,updater:y,references:1})}a.push(f)}return a}function o(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var i=r(e=e||[],o=o||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var u=n(i[a]);t[u].references--}for(var c=r(e,o),s=0;s<i.length;s++){var l=n(i[s]);0===t[l].references&&(t[l].updater(),t.splice(l,1))}i=c}}},569:e=>{"use strict";var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},795:e=>{"use strict";e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={id:r,exports:{}};return e[r](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r={};return(()=>{"use strict";n.d(r,{default:()=>rt});var e,t=n(773),o=n.n(t),i=function(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0},a="http://www.w3.org/2000/svg",u=function(e){var t=e.getAttribute("class");return t?new Set(t.split(" ")):new Set},c=function(e,t){var n=u(e);n.add(t),e.setAttribute("class",Array.from(n).join(" "))},s=function(e,t){var n=u(e);n.delete(t),0===n.size?e.removeAttribute("class"):e.setAttribute("class",Array.from(n).join(" "))},l=function(e,t){return u(e).has(t)},f=new Uint8Array(16);function d(){if(!e&&!(e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return e(f)}const p=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,y=function(e){return"string"==typeof e&&p.test(e)};for(var b=[],h=0;h<256;++h)b.push((h+256).toString(16).substr(1));const v=function(e,t,n){var r=(e=e||{}).random||(e.rng||d)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(b[e[t+0]]+b[e[t+1]]+b[e[t+2]]+b[e[t+3]]+"-"+b[e[t+4]]+b[e[t+5]]+"-"+b[e[t+6]]+b[e[t+7]]+"-"+b[e[t+8]]+b[e[t+9]]+"-"+b[e[t+10]]+b[e[t+11]]+b[e[t+12]]+b[e[t+13]]+b[e[t+14]]+b[e[t+15]]).toLowerCase();if(!y(n))throw TypeError("Stringified UUID is invalid");return n}(r)};var m=n(94),g=n.n(m);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),A(this,"clone",(function(t,n){return new e(S(S({},r.underlying),t),S(S({},r.opts),n))})),A(this,"selector",(function(e){var t=r.underlying.target;if(t.selector)return(Array.isArray(t.selector)?t.selector:[t.selector]).find((function(t){return t.type===e}))})),this.underlying=t,this.opts=n}var t,n;return t=e,(n=[{key:"isEqual",value:function(e){return"Annotation"===(null==e?void 0:e.type)&&(this.underlying===e.underlying||!(!this.underlying.id||!e.underlying.id)&&g()(this.underlying,e.underlying))}},{key:"readOnly",get:function(){var e;return null===(e=this.opts)||void 0===e?void 0:e.readOnly}},{key:"id",get:function(){return this.underlying.id}},{key:"type",get:function(){return this.underlying.type}},{key:"motivation",get:function(){return this.underlying.motivation}},{key:"body",get:function(){return this.underlying.body}},{key:"target",get:function(){return this.underlying.target}},{key:"bodies",get:function(){return Array.isArray(this.underlying.body)?this.underlying.body:[this.underlying.body]},set:function(e){this.underlying.body=e}},{key:"targets",get:function(){return Array.isArray(this.underlying.target)?this.underlying.target:[this.underlying.target]}},{key:"quote",get:function(){return this.selector("TextQuoteSelector").exact}},{key:"start",get:function(){return this.selector("TextPositionSelector").start}},{key:"end",get:function(){return this.selector("TextPositionSelector").end}}])&&O(t.prototype,n),e}();function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){k(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}A(E,"create",(function(e){var t={"@context":"http://www.w3.org/ns/anno.jsonld",type:"Annotation",id:"#".concat(v()),body:[]};return new E(S(S({},t),e))}));var C=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),k(this,"clone",(function(t){var n=new e;return n.underlying=JSON.parse(JSON.stringify(r.underlying)),t&&(n.underlying=j(j({},n.underlying),t)),n})),k(this,"selector",(function(e){var t=r.underlying.target;if(t.selector)return(Array.isArray(t.selector)?t.selector:[t.selector]).find((function(t){return t.type===e}))})),k(this,"toAnnotation",(function(){var e=Object.assign({},r.underlying,{"@context":"http://www.w3.org/ns/anno.jsonld",type:"Annotation",id:"#".concat(v())});return new E(e)})),this.underlying={type:"Selection",body:n||[],target:t}}var t,n;return t=e,(n=[{key:"type",get:function(){return this.underlying.type}},{key:"body",get:function(){return this.underlying.body}},{key:"target",get:function(){return this.underlying.target}},{key:"targets",get:function(){return Array.isArray(this.underlying.target)?this.underlying.target:[this.underlying.target]}},{key:"isEqual",value:function(e){return!!e&&g()(this.underlying,e.underlying)}},{key:"bodies",get:function(){return Array.isArray(this.underlying.body)?this.underlying.body:[this.underlying.body]}},{key:"quote",get:function(){return this.selector("TextQuoteSelector").exact}},{key:"isSelection",get:function(){return!0}}])&&x(t.prototype,n),e}();function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}function R(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(e,t,n){return t&&T(e.prototype,t),n&&T(e,n),e}function D(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&H(e,t)}function H(e,t){return H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},H(e,t)}function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=q(e);if(t){var o=q(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return L(this,n)}}function L(e,t){if(t&&("object"===M(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return B(e)}function B(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function q(e){return q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},q(e)}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var I="An implementation is missing",z=i(),V=function(e){D(n,e);var t=N(n);function n(e,r,o){var i;R(this,n),U(B(i=t.call(this)),"enableResponsive",(function(){window.ResizeObserver&&(i.resizeObserver=new ResizeObserver((function(){var e=i.svg.getBoundingClientRect(),t=i.svg.viewBox.baseVal,n=t.width,r=t.height;i.scale=Math.max(n/e.width,r/e.height),i.onScaleChanged&&i.onScaleChanged(i.scale)})),i.resizeObserver.observe(i.svg.parentNode))})),U(B(i),"getSVGPoint",(function(e){var t=i.svg.createSVGPoint();if(z){var n=i.svg.getBoundingClientRect(),r=e.clientX-n.x,o=e.clientY-n.y,a=i.svg.getBoundingClientRect(),u=a.left,c=a.top;return t.x=r+u,t.y=o+c,t.matrixTransform(i.g.getScreenCTM().inverse())}return t.x=e.offsetX,t.y=e.offsetY,t.matrixTransform(i.g.getCTM().inverse())})),U(B(i),"drawHandle",(function(e,t){var n=document.createElementNS(a,"g");n.setAttribute("class","a9s-handle");var r=document.createElementNS(a,"g"),o=function(n){var r=document.createElementNS(a,"circle");return r.setAttribute("cx",e),r.setAttribute("cy",t),r.setAttribute("r",n),r},u=i.config.handleRadius||6,c=o(u);c.setAttribute("class","a9s-handle-inner");var s=o(u+1);return s.setAttribute("class","a9s-handle-outer"),r.appendChild(s),r.appendChild(c),n.appendChild(r),n})),U(B(i),"setHandleXY",(function(e,t,n){var r=e.querySelector(".a9s-handle-inner");r.setAttribute("cx",t),r.setAttribute("cy",n);var o=e.querySelector(".a9s-handle-outer");o.setAttribute("cx",t),o.setAttribute("cy",n)})),U(B(i),"getHandleXY",(function(e){var t=e.querySelector(".a9s-handle-outer");return{x:parseFloat(t.getAttribute("cx")),y:parseFloat(t.getAttribute("cy"))}})),U(B(i),"scaleHandle",(function(e){var t=e.querySelector(".a9s-handle-inner"),n=e.querySelector(".a9s-handle-outer"),r=i.scale*(i.config.handleRadius||6);t.setAttribute("r",r),n.setAttribute("r",r)})),i.svg=e.closest("svg"),i.g=e,i.config=r,i.env=o,i.scale=1;var u=o.image;return(u instanceof Element||u instanceof HTMLDocument)&&i.enableResponsive(),i}return _(n,[{key:"destroy",value:function(){this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeObserver=null}}]),n}(o()),G=function(e){D(n,e);var t=N(n);function n(e,r,o){var i;return R(this,n),U(B(i=t.call(this,e,r,o)),"attachListeners",(function(e){var t=e.mouseMove,n=e.mouseUp,r=e.dblClick;t&&(i.mouseMove=function(e){var n=i.getSVGPoint(e),r=n.x,o=n.y;i.started||(i.emit("startSelection",{x:r,y:o}),i.started=!0),t(r,o,e)},i.svg.addEventListener("mousemove",i.mouseMove)),n&&(i.mouseUp=function(e){if(0===e.button){var t=i.getSVGPoint(e),r=t.x,o=t.y;n(r,o,e)}},document.addEventListener("mouseup",i.mouseUp)),r&&(i.dblClick=function(e){var t=i.getSVGPoint(e),n=t.x,o=t.y;r(n,o,e)},document.addEventListener("dblclick",i.dblClick))})),U(B(i),"detachListeners",(function(){i.mouseMove&&i.svg.removeEventListener("mousemove",i.mouseMove),i.mouseUp&&document.removeEventListener("mouseup",i.mouseUp),i.dblClick&&document.removeEventListener("dblclick",i.dblClick)})),U(B(i),"start",(function(e,t){var n=i.getSVGPoint(e),r=n.x,o=n.y;i.startDrawing(r,o,t,e)})),U(B(i),"startDrawing",(function(e){throw new Error(I)})),U(B(i),"createEditableShape",(function(e){throw new Error(I)})),i.started=!1,i}return _(n,[{key:"isDrawing",get:function(){throw new Error(I)}}]),n}(V);function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}function X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function K(e,t){return K=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},K(e,t)}function W(e,t){if(t&&("object"===F(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Y(e)}function Y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Z(e){return Z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Z(e)}G.supports=function(e){throw new Error(I)};var J="An implementation is missing",$=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&K(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Z(r);if(o){var n=Z(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return W(this,e)});function a(e,t,n,r){var o,u,c,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),s=function(e){throw new Error(J)},(c="updateState")in(u=Y(o=i.call(this,t,n,r)))?Object.defineProperty(u,c,{value:s,enumerable:!0,configurable:!0,writable:!0}):u[c]=s,o.annotation=e,o}return t=a,(n=[{key:"element",get:function(){throw new Error(J)}}])&&X(t.prototype,n),a}(V),Q=function(e){var t=function(e){Array.from(e.attributes).forEach((function(t){t.name.startsWith("on")&&e.removeAttribute(t.name)}))},n=e.getElementsByTagName("script");return Array.from(n).reverse().forEach((function(e){return e.parentNode.removeChild(e)})),t(e),Array.from(e.querySelectorAll("*")).forEach(t),e},ee=function(e){var t=function(e){var t,n,r=e.selector("SvgSelector");if(r){var o=new DOMParser,i=r.value,u=o.parseFromString(i,"image/svg+xml"),c=u.lookupPrefix(a),s=u.lookupNamespaceURI(null);return c||s?Q(u).firstChild:Q((t=u,n=(new XMLSerializer).serializeToString(t.documentElement).replace("<svg>",'<svg xmlns="'.concat(a,'">')),(new DOMParser).parseFromString(n,"image/svg+xml").documentElement)).firstChild}}(e),n=document.createElementNS(a,"g"),r=t.cloneNode(!0);r.setAttribute("class","a9s-inner");var o=t.cloneNode(!0);return o.setAttribute("class","a9s-outer"),n.appendChild(o),n.appendChild(r),n},te=/firefox/i.test(navigator.userAgent),ne=function(e,t,n,r,o){e.setAttribute("width",r),e.setAttribute("height",o),te?(e.setAttribute("x",0),e.setAttribute("y",0),e.setAttribute("transform","translate(".concat(t,", ").concat(n,")"))):(e.setAttribute("x",t),e.setAttribute("y",n))},re=function(e,t){var n=t.getBBox(),r=n.x,o=n.y,i=n.width,u=n.height,c=document.createElementNS(a,"svg");c.setAttribute("class","a9s-formatter-el"),ne(c,r,o,i,u);var s=document.createElementNS(a,"g");s.appendChild(e),c.appendChild(s),t.append(c)};function oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ae=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ie(this,"redraw",(function(){r.mask.setAttribute("d","M0 0 h".concat(r.w," v").concat(r.h," h-").concat(r.w," z M").concat(r.polygon.getAttribute("points")," z"))})),ie(this,"destroy",(function(){return r.mask.parentNode.removeChild(r.mask)})),this.w=t.naturalWidth,this.h=t.naturalHeight,this.polygon=n,this.mask=document.createElementNS(a,"path"),this.mask.setAttribute("fill-rule","evenodd"),this.mask.setAttribute("class","a9s-selection-mask"),this.mask.setAttribute("d","M0 0 h".concat(this.w," v").concat(this.h," h-").concat(this.w," z M").concat(this.polygon.getAttribute("points")," z"))}var t,n;return t=e,(n=[{key:"element",get:function(){return this.mask}}])&&oe(t.prototype,n),e}();function ue(e){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ue(e)}function ce(e){return function(e){if(Array.isArray(e))return se(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?se(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fe(e,t){return fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},fe(e,t)}function de(e,t){if(t&&("object"===ue(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return pe(e)}function pe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ye(e,t,n){return ye="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=be(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}},ye(e,t,n||e)}function be(e){return be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},be(e)}function he(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ve=function(e){return Array.from(e.querySelector(".a9s-inner").points)},me=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fe(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=be(r);if(o){var n=be(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return de(this,e)});function u(e,t,n,r){var o,f;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),he(pe(f=i.call(this,e,t,n,r)),"createCornerHandle",(function(e){var t=f.drawHandle(e.x,e.y);return t.addEventListener("mousedown",f.onGrab(t)),t.addEventListener("click",f.onSelectCorner(t)),f.scaleHandle(t),f.shape.appendChild(t),t})),he(pe(f),"createMidpoint",(function(e,t){var n=e[t],r=t===e.length-1?e[0]:e[t+1],o=(n.x+r.x)/2,i=(n.y+r.y)/2,a=f.drawMidpoint(o,i);return a.addEventListener("mousedown",f.onGrab(a)),f.shape.appendChild(a),a})),he(pe(f),"deleteSelected",(function(){var e=ve(f.shape);if(f.selected.length>0&&e.length-f.selected.length>2){var t=e.filter((function(e,t){return!f.selected.includes(t)}));return f.cornerHandles.filter((function(e,t){return f.selected.includes(t)})).forEach((function(e){return e.parentNode.removeChild(e)})),f.cornerHandles=f.cornerHandles.filter((function(e,t){return!f.selected.includes(t)})),f.midpoints.filter((function(e,t){return f.selected.includes(t)})).forEach((function(e){return e.parentNode.removeChild(e)})),f.midpoints=f.midpoints.filter((function(e,t){return!f.selected.includes(t)})),f.setPoints(t),f.emit("update",Ie(t.map((function(e){return[e.x,e.y]})),f.env.image)),!0}return!1})),he(pe(f),"deselectCorners",(function(){return f.cornerHandles.forEach((function(e){return s(e,"selected")}))})),he(pe(f),"destroy",(function(){f.container.parentNode.removeChild(f.container),f.svg.removeEventListener("mousemove",f.onMouseMove),f.svg.removeEventListener("mouseup",f.onMouseUp),f.svg.removeEventListener("keyup",f.onKeyUp),ye((o=pe(f),be(u.prototype)),"destroy",o).call(o)})),he(pe(f),"drawMidpoint",(function(e,t){var n=document.createElementNS(a,"circle");return n.setAttribute("class","a9s-midpoint"),n.setAttribute("cx",e),n.setAttribute("cy",t),n.setAttribute("r",5*f.scale),n})),he(pe(f),"onAddPoint",(function(e){var t=ve(f.shape),n=f.midpoints.indexOf(f.grabbedElement)+1,r=[].concat(ce(t.slice(0,n)),[e],ce(t.slice(n))),o=f.createCornerHandle(e);f.cornerHandles=[].concat(ce(f.cornerHandles.slice(0,n)),[o],ce(f.cornerHandles.slice(n)));var i=f.createMidpoint(r,n-1),a=f.createMidpoint(r,n);f.midpoints=[].concat(ce(f.midpoints.slice(0,n-1)),[i,a],ce(f.midpoints.slice(n))),f.grabbedElement.parentNode.removeChild(f.grabbedElement),f.grabbedElement=o,f.onSelectCorner(o)(),f.setPoints(r)})),he(pe(f),"onGrab",(function(e){return function(t){0===t.button&&(t.stopPropagation(),f.grabbedElement=e,f.grabbedAt=f.getSVGPoint(t),f.lastMouseDown=(new Date).getTime())}})),he(pe(f),"onKeyUp",(function(e){46===e.which&&f.deleteSelected()&&(e.preventDefault(),e.stopImmediatePropagation())})),he(pe(f),"onMoveShape",(function(e){var t=function(e,t,n){return e+t<0?-e:e+t>n?n-e:t},n=f.shape.querySelector(".a9s-inner").getBBox(),r=n.x,o=n.y,i=n.width,a=n.height,u=f.env.image,c=u.naturalWidth,s=u.naturalHeight,l=t(r,e.x-f.grabbedAt.x,c-i),d=t(o,e.y-f.grabbedAt.y,s-a),p=ve(f.shape).map((function(e){return{x:e.x+l,y:e.y+d}}));f.grabbedAt=e,f.setPoints(p)})),he(pe(f),"onMoveCornerHandle",(function(e,t){var n=f.cornerHandles.indexOf(f.grabbedElement);t.ctrlKey?f.selected=Array.from(new Set([].concat(ce(f.selected),[n]))):f.selected.includes(n)||(f.selected=[n]);var r=ve(f.shape),o=f.selected.map((function(e){var t=r[n],o=r[e];return{index:e,dx:o.x-t.x,dy:o.y-t.y}})),i=ve(f.shape).map((function(t,r){if(r===n)return e;if(f.selected.includes(r)){var i=o.find((function(e){return e.index===r})),a=i.dx,u=i.dy;return{x:e.x+a,y:e.y+u}}return t}));f.setPoints(i)})),he(pe(f),"onMouseMove",(function(e){if(f.grabbedElement){var t=f.getSVGPoint(e);f.grabbedElement===f.shape?f.onMoveShape(t):l(f.grabbedElement,"a9s-handle")?f.onMoveCornerHandle(t,e):l(f.grabbedElement,"a9s-midpoint")&&f.onAddPoint(t);var n=ve(f.shape).map((function(e){return[e.x,e.y]}));f.emit("update",Ie(n,f.env.image))}})),he(pe(f),"onMouseUp",(function(e){f.grabbedElement=null,f.grabbedAt=null})),he(pe(f),"onScaleChanged",(function(e){f.cornerHandles.map(f.scaleHandle),f.midpoints.map((function(e){e.setAttribute("r",5*f.scale)}))})),he(pe(f),"onSelectCorner",(function(e){return function(t){if(!((new Date).getTime()-f.lastMouseDown>250)){var n=f.cornerHandles.indexOf(e);null!=t&&t.ctrlKey?f.selected.includes(n)?f.selected=f.selected.filter((function(e){return e!==n})):f.selected=[].concat(ce(f.selected),[n]):1===f.selected.length&&f.selected[0]===n?f.selected=[]:f.selected=[n],f.setPoints(ve(f.shape))}}})),he(pe(f),"setPoints",(function(e){var t=function(e){return Math.round(10*e)/10},n=e.map((function(e){return"".concat(t(e.x),",").concat(t(e.y))})).join(" ");f.shape.querySelector(".a9s-inner").setAttribute("points",n);var r=f.shape.querySelector(".a9s-outer");r.setAttribute("points",n),e.forEach((function(e,t){return f.setHandleXY(f.cornerHandles[t],e.x,e.y)})),f.cornerHandles.forEach((function(e,t){var n=f.selected.includes(t);n&&!l(e,"selected")?c(e,"selected"):!n&&l(e,"selected")&&s(e,"selected")}));for(var o=0;o<e.length;o++){var i=e[o],a=o===e.length-1?e[0]:e[o+1],u=(i.x+a.x)/2,d=(i.y+a.y)/2,p=f.midpoints[o];p.setAttribute("cx",u),p.setAttribute("cy",d)}f.mask.redraw();var y=r.getBBox(),b=y.x,h=y.y,v=y.width,m=y.height;!function(e,t,n,r,o){var i=e.querySelector(".a9s-formatter-el");i&&ne(i,t,n,r,o)}(f.shape,b,h,v,m)})),he(pe(f),"updateState",(function(e){var t=ee(e),n=ve(t);f.setPoints(n)})),f.svg.addEventListener("mousemove",f.onMouseMove),f.svg.addEventListener("mouseup",f.onMouseUp),f.svg.addEventListener("keyup",f.onKeyUp),f.container=document.createElementNS(a,"g"),f.shape=ee(e),f.shape.setAttribute("class","a9s-annotation editable selected improved-polygon");var d=f.shape.querySelector(".a9s-inner");d.addEventListener("mousedown",f.onGrab(f.shape)),f.mask=new ae(r.image,d),f.container.appendChild(f.mask.element),f.container.appendChild(f.shape);var p=ve(f.shape);return f.cornerHandles=p.map(f.createCornerHandle),f.midpoints=p.map((function(e,t){return f.createMidpoint(p,t)})),t.appendChild(f.container),function(e,t,n){if(!n)return e;var r=n(t);if(!r)return e;if("string"==typeof r||r instanceof String)c(e,r);else if(r.nodeType===Node.ELEMENT_NODE)re(r,e);else{var o=r.className,i=r.style,a=r.element;if(o&&c(e,o),i){var u=e.querySelector(".a9s-outer"),s=e.querySelector(".a9s-inner");u&&s?(u.setAttribute("style","display:none"),s.setAttribute("style",i)):e.setAttribute("style",i)}for(var l in a&&re(a,e),r)r.hasOwnProperty(l)&&l.startsWith("data-")&&e.setAttribute(l,r[l])}}(f.shape,e,n.formatter),f.grabbedElement=null,f.grabbedAt=null,f.selected=[],f.lastMouseDown=null,f}return t=u,(n=[{key:"element",get:function(){return this.shape}}])&&le(t.prototype,n),u}($);function ge(e){return ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ge(e)}function we(e){return function(e){if(Array.isArray(e))return Pe(e)}(e)||Se(e)||Ee(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Se(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Oe(e,t){return je(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){u=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(e,t)||Ee(e,t)||Ae()}function Ae(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ee(e,t){if(e){if("string"==typeof e)return Pe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pe(e,t):void 0}}function Pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function je(e){if(Array.isArray(e))return e}function xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ke(e,t){return ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ke(e,t)}function Ce(e,t){if(t&&("object"===ge(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Me(e)}function Me(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Re(e){return Re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Re(e)}function Te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _e=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ke(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Re(r);if(o){var n=Re(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ce(this,e)});function u(e,t,n,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),Te(Me(o=i.call(this,t,n,r)),"addPoint",(function(){if(o.isClosable())o.close();else{var e=Oe(o.mousepos,2),t=e[0],n=e[1],r=o.points[o.points.length-1];Math.pow(t-r[0],2)+Math.pow(n-r[1],2)>4&&(o.points=[].concat(we(o.points),[o.mousepos]),o.setPoints(o.points),o.mask.redraw())}})),Te(Me(o),"close",(function(){var e=new C(Ie(o.points,o.env.image));o.emit("close",{shape:o.selection,selection:e})})),Te(Me(o),"destroy",(function(){o.container.parentNode.removeChild(o.container)})),Te(Me(o),"dragTo",(function(e){o.container.style.display=null,o.mousepos=e;var t=o.getDistanceToStart();o.closeHandle.style.display=t<40?null:"none",t<20&&(o.mousepos=o.points[0]),o.setPoints([].concat(we(o.points),[o.mousepos])),o.mask.redraw()})),Te(Me(o),"getBoundingClientRect",(function(){return o.rubberband.getBoundingClientRect()})),Te(Me(o),"getDistanceToStart",(function(){if(o.points.length<3)return 1/0;var e=Math.abs(o.mousepos[0]-o.points[0][0]),t=Math.abs(o.mousepos[1]-o.points[0][1]);return Math.sqrt(Math.pow(e,2)+Math.pow(t,2))/o.scale})),Te(Me(o),"isClosable",(function(){return o.getDistanceToStart()<6*o.scale})),Te(Me(o),"onScaleChanged",(function(e){o.scale=e;var t=o.closeHandle.querySelector(".a9s-handle-inner"),n=o.closeHandle.querySelector(".a9s-handle-outer"),r=e*(o.config.handleRadius||6);t.setAttribute("r",r),n.setAttribute("r",r)})),Te(Me(o),"pop",(function(){o.points.pop(),o.setPoints(o.points),o.mask.redraw()})),Te(Me(o),"setPoints",(function(e){var t=function(e){return je(e)||Se(e)||Ee(e)||Ae()}(e),n=t[0],r=t.slice(1),i="M ".concat(n[0]," ").concat(n[1]," ")+r.map((function(e){var t=Oe(e,2),n=t[0],r=t[1];return"L ".concat(n," ").concat(r)})).join(" ");o.outerPath.setAttribute("d",i),o.innerPath.setAttribute("d",i);var a=e.map((function(e){return"".concat(e[0],",").concat(e[1])})).join(" ");o.rubberband.setAttribute("points",a)})),o.env=r,o.scale=1,o.points=[e],o.mousepos=e,o.container=document.createElementNS(a,"g"),o.selection=document.createElementNS(a,"g"),o.selection.setAttribute("class","a9s-selection improved-polygon"),o.outerPath=document.createElementNS(a,"path"),o.outerPath.setAttribute("class","a9s-outer"),o.innerPath=document.createElementNS(a,"path"),o.innerPath.setAttribute("class","a9s-inner"),o.rubberband=document.createElementNS(a,"polygon"),o.rubberband.setAttribute("class","a9s-rubberband"),o.closeHandle=o.drawHandle(e[0],e[1]),o.closeHandle.style.display="none",o.setPoints(o.points),o.selection.appendChild(o.rubberband),o.selection.appendChild(o.outerPath),o.selection.appendChild(o.innerPath),o.selection.appendChild(o.closeHandle),o.mask=new ae(r.image,o.rubberband),o.container.style.display="none",o.container.appendChild(o.mask.element),o.container.appendChild(o.selection),t.appendChild(o.container),o}return t=u,(n=[{key:"element",get:function(){return this.selection}}])&&xe(t.prototype,n),u}(V);function De(e){return De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},De(e)}function He(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ne(e,t){return Ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ne(e,t)}function Le(e,t){if(t&&("object"===De(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Be(e)}function Be(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qe(e){return qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},qe(e)}function Ue(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}i();var Ie=function(e,t){return{source:null==t?void 0:t.src,selector:{type:"SvgSelector",value:'<svg><polygon points="'.concat(e.map((function(e){return"".concat(e[0],",").concat(e[1])})).join(" "),'" /></svg>')}}},ze=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ne(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=qe(r);if(o){var n=qe(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Le(this,e)});function a(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),Ue(Be(r=i.call(this,e,t,n)),"startDrawing",(function(e,t,n){r._isDrawing=!0,r._startOnSingleClick=n,r.attachListeners({mouseMove:r.onMouseMove,mouseUp:r.onMouseUp,dblClick:r.onDblClick}),r.rubberband=new _e([e,t],r.g,r.config,r.env),r.rubberband.on("close",(function(e){var t=e.shape,n=e.selection;t.annotation=n,r.emit("complete",t),r.stop()}))})),Ue(Be(r),"stop",(function(){r.detachListeners(),r._isDrawing=!1,r.rubberband&&(r.rubberband.destroy(),r.rubberband=null)})),Ue(Be(r),"onDblClick",(function(){var e;(null===(e=r.rubberband)||void 0===e?void 0:e.points.length)>2&&(r.rubberband.close(),r.stop())})),Ue(Be(r),"onMouseMove",(function(e,t){return r.rubberband.dragTo([e,t])})),Ue(Be(r),"onMouseUp",(function(){var e=r.rubberband.getBoundingClientRect(),t=e.width,n=e.height,o=r.config.minSelectionWidth||4,i=r.config.minSelectionHeight||4;t>=o||n>=i?r.rubberband.addPoint():r._startOnSingleClick||(r.emit("cancel"),r.stop())})),Ue(Be(r),"onScaleChanged",(function(e){r.rubberband&&r.rubberband.onScaleChanged(e)})),Ue(Be(r),"createEditableShape",(function(e){return new me(e,r.g,r.config,r.env)})),r._isDrawing=!1,r._startOnSingleClick=!1,r}return t=a,(n=[{key:"isDrawing",get:function(){return this._isDrawing}}])&&He(t.prototype,n),a}(G);ze.identifier="polygon",ze.supports=function(e){var t,n=e.selector("SvgSelector");if(n)return null===(t=n.value)||void 0===t?void 0:t.match(/^<svg.*<polygon/g)};var Ve=n(379),Ge=n.n(Ve),Fe=n(795),Xe=n.n(Fe),Ke=n(569),We=n.n(Ke),Ye=n(565),Ze=n.n(Ye),Je=n(216),$e=n.n(Je),Qe=n(589),et=n.n(Qe),tt=n(424),nt={};nt.styleTagTransform=et(),nt.setAttributes=Ze(),nt.insert=We().bind(null,"head"),nt.domAPI=Xe(),nt.insertStyleElement=$e(),Ge()(tt.Z,nt),tt.Z&&tt.Z.locals&&tt.Z.locals;const rt=function(e){e.addDrawingTool(ze)}})(),r.default})()}));